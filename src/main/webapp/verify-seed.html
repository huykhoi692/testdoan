<!doctype html>
<html>
  <head>
    <title>LangLeague Seed Data Verification</title>
    <style>
      body {
        font-family: Arial;
        margin: 20px;
      }
      .container {
        max-width: 800px;
        margin: 0 auto;
      }
      table {
        border-collapse: collapse;
        width: 100%;
        margin: 20px 0;
      }
      th,
      td {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: left;
      }
      th {
        background-color: #667eea;
        color: white;
      }
      .success {
        color: green;
      }
      .error {
        color: red;
      }
      button {
        padding: 10px 20px;
        font-size: 16px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>✓ LangLeague Seed Data Verification</h1>

      <h2>Step 1: Verify API Connection</h2>
      <button onclick="testAPI()">Test Backend API</button>
      <div id="apiStatus"></div>

      <h2>Step 2: Check Vocabulary Data</h2>
      <button onclick="loadWords()">Load Vocabulary</button>
      <div id="wordsList"></div>

      <h2>Step 3: Test TTS Feature</h2>
      <button onclick="testTTS()">Test Text-to-Speech</button>
      <div id="ttsStatus"></div>
    </div>

    <script>
      async function testAPI() {
        const status = document.getElementById('apiStatus');
        try {
          const response = await fetch('http://localhost:8080/management/health');
          if (response.ok) {
            status.innerHTML = '<p class="success">✓ Backend is running!</p>';
          } else {
            status.innerHTML = '<p class="error">✗ Backend returned error: ' + response.status + '</p>';
          }
        } catch (e) {
          status.innerHTML = '<p class="error">✗ Cannot connect to backend: ' + e.message + '</p>';
        }
      }

      async function loadWords() {
        const wordsList = document.getElementById('wordsList');
        try {
          const response = await fetch('http://localhost:8080/api/words');
          if (response.ok) {
            const words = await response.json();
            let html = `<p class="success">✓ Found ${words.length} vocabulary words!</p>`;
            html += '<table>';
            html += '<tr><th>ID</th><th>Text</th><th>Meaning</th><th>Pronunciation</th></tr>';
            words.slice(0, 5).forEach(word => {
              html += `<tr>
                            <td>${word.id}</td>
                            <td>${word.text}</td>
                            <td>${word.meaning}</td>
                            <td>${word.pronunciation}</td>
                        </tr>`;
            });
            html += '</table>';
            wordsList.innerHTML = html;
          } else {
            wordsList.innerHTML = '<p class="error">✗ API error: ' + response.status + '</p>';
          }
        } catch (e) {
          wordsList.innerHTML = '<p class="error">✗ Cannot load words: ' + e.message + '</p>';
        }
      }

      async function testTTS() {
        const ttsStatus = document.getElementById('ttsStatus');
        try {
          // Test Google TTS API
          const response = await fetch(
            'https://texttospeech.googleapis.com/v1/text:synthesize?key=AIzaSyCICuOBfy1Q-AFo9zNPiR4QZLatVfkPLMg',
            {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                input: { text: 'Hello' },
                voice: {
                  languageCode: 'en-US',
                  ssmlGender: 'FEMALE',
                },
                audioConfig: {
                  audioEncoding: 'MP3',
                },
              }),
            },
          );

          if (response.ok) {
            const data = await response.json();
            if (data.audioContent) {
              ttsStatus.innerHTML = '<p class="success">✓ TTS API is working! Audio received.</p>';
              // Play audio
              const audioData = 'data:audio/mp3;base64,' + data.audioContent;
              const audio = new Audio(audioData);
              audio.play();
            }
          } else {
            ttsStatus.innerHTML = '<p class="error">✗ TTS API error: ' + response.status + '</p>';
          }
        } catch (e) {
          ttsStatus.innerHTML = '<p class="error">✗ TTS error: ' + e.message + '</p>';
        }
      }
    </script>
  </body>
</html>
